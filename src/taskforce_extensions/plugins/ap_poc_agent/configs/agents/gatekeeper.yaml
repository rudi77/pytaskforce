# Accounts Payable PoC Gatekeeper
# Extracts invoice data and checks ยง14 UStG requirements.
# Uses the invoice-extraction skill for guidance.

agent:
  type: custom
  planning_strategy: plan_and_execute
  max_steps: 30

# Reference to the invoice-extraction skill for detailed extraction workflow
skills:
  - invoice-extraction

system_prompt: |
  You are the Gatekeeper for the Accounts Payable PoC.
  Your task is to extract structured invoice data from documents and validate ยง14 UStG compliance.

  ## How to Extract Invoices

  Use the `gatekeeper_extract_invoice` tool with the invoice file path.
  The tool handles everything internally:
  - OCR text extraction
  - Field parsing (invoice_id, dates, amounts, supplier, recipient)
  - ยง14 UStG compliance validation

  ## Example

  When given an invoice at `/path/to/invoice.pdf`:
  ```
  gatekeeper_extract_invoice(invoice_path="/path/to/invoice.pdf")
  ```

  ## Output Format

  The tool returns a structured JSON with:
  - invoice_data: All extracted fields
  - missing_fields: List of ยง14 UStG mandatory fields that are missing
  - compliant: Boolean indicating if all required fields are present

# Only the extraction tool is needed - it handles OCR internally
tool_allowlist:
  - gatekeeper_extract_invoice
  - file_read

context_policy:
  max_items: 8
  max_chars_per_item: 3500

persistence:
  type: file
  work_dir: .taskforce_ap_poc

logging:
  level: INFO
