# Coding Agent Development Configuration
# Specialized agent for software development tasks

profile: coding_agent
specialist: coding  # Determines system prompt (Kernel + Coding Specialist)

# Custom system prompt for multi-agent orchestration
system_prompt: |
  You are a coding orchestrator that delegates work to specialist sub-agents.

  Use the sub-agent tools to run a multi-step workflow:
  1. Ask coding_planner to break the mission into concrete tasks and priorities.
  2. Dispatch coding_worker to implement each task (parallelize if independent).
  3. Dispatch coding_reviewer to review changes, tests, and quality.
  4. Consolidate results and deliver a final answer to the user.

  Keep orchestration focused:
  - Provide each sub-agent with clear mission scope and expected outputs.
  - Summarize and reconcile findings from all sub-agents.
  - If review finds issues, send fixes back to coding_worker.

# Persistence configuration
persistence:
  type: file
  work_dir: .taskforce_coding

# Agent configuration
agent:
  enable_fast_path: true  # Enable fast-path for follow-up queries
  planning_strategy: spar  # Sense-Plan-Act-Reflect for orchestration
  max_parallel_tools: 3
  router:
    use_llm_classification: true  # Use LLM for better accuracy in prod
    max_follow_up_length: 100  # Max query length for follow-up classification


# LLM configuration
llm:
  config_path: src/taskforce_extensions/configs/llm_config.yaml
  default_model: main

# Logging configuration
logging:
  level: DEBUG
  format: console

# Context Policy configuration (Story 9.2)
# Controls budgeting for context pack injection before LLM calls
context_policy:
  max_items: 10                      # Maximum number of items in context pack
  max_chars_per_item: 500            # Maximum characters per individual item
  max_total_chars: 3000              # Maximum total characters across all items
  include_latest_tool_previews_n: 5  # Number of latest tool previews to include
  allow_tools: null                  # null = all tools allowed, or list of tool names
  allow_selectors:                   # Selector types to use (MVP: first_chars)
    - first_chars

# Tool configuration for coding agent
# These tools override the specialist defaults when defined
# Claude Code style tools for software development
tools:
  # File reading and searching (Claude Code style)
  - file_read      # Read file contents
  - grep           # Search file contents with regex patterns
  - glob           # Find files by name patterns

  # File modification (Claude Code style)
  - file_write     # Write entire file
  - edit           # Exact string replacement (surgical edits)

  # Multimedia support (Claude Code style)
  - multimedia     # Read images, PDFs, notebooks

  # Shell and execution
  - powershell     # Execute shell commands
  - python         # Execute Python code

  # User interaction and LLM
  - ask_user       # Ask user for clarification
  - llm            # Generate content with LLM

  # Version control
  - git            # Git operations
  - memory         # Unified memory tool

  # Sub-agent tools (explicitly defined)
  - type: sub_agent
    name: coding_planner
  - type: sub_agent
    name: coding_worker
  - type: sub_agent
    name: coding_reviewer

# Unified Memory Configuration
memory:
  type: file
  store_dir: ".taskforce_coding/memory"
